<launch>
  <!-- Args to enable each sensor -->
  <arg name="use_lidar" default="true" />
  <arg name="lidar_min_dist" default="0.4" />
  <arg name="use_lidar_front" default="true" />
  <arg name="lidar_front_min_dist" default="0.4" />
  <arg name="use_camera_fl" default="false" />
  <arg name="use_camera_fr" default="false" />
  <arg name="use_radar_fc" default="false" />
  <arg name="use_gps" default="false" />
  <arg name="use_dbw" default="false" />
  <arg name="use_ssc" default="false" />
  <arg name="use_tf" default="false" />
  <arg name="use_diagnostics" default="true" />

  <!-- LIDAR -->
  <group if="$(arg use_lidar)">
    <remap from="/velodyne_points" to="/points_raw_center" />
    <remap from="/velodyne_packets" to="/velodyne_packets_center" />
    <remap from="/scan" to="/scan_center" />

    <include file="$(find velodyne_pointcloud)/launch/VLP-32C_points.launch">
      <arg name="frame_id" value="lidar" />
      <arg name="device_ip" value="192.168.1.201" />
      <arg name="min_range" value="$(arg lidar_min_dist)" />
    </include>
  </group>

  <!-- LIDAR Front -->
  <group if="$(arg use_lidar_front)">
    <remap from="/velodyne_points" to="/points_raw_front" />
    <remap from="/velodyne_packets" to="/velodyne_packets_front" />
    <remap from="/scan" to="/scan_front" />

    <include if="$(arg use_lidar_front)" file="$(find velodyne_pointcloud)/launch/VLP16_points.launch">
      <arg name="frame_id" value="lidar_front" />
      <arg name="device_ip" value="192.168.2.12" />
      <arg name="min_range" value="$(arg lidar_front_min_dist)" />
      <arg name="port" value="2369" />
    </include>
  </group>

  <!-- CAMERAS -->
  <!-- Front Left Camera -->
  <include if="$(arg use_camera_fl)" file="$(find vehicle_platform)/launch/avt_vimba_camera.launch">
    <arg name="name" value="camera_fl" />
    <arg name="frame_id" value="camera_fl" />
    <arg name="ip" value="192.168.20.1" />
    <arg name="acquisition_rate" value="20" />
  </include>

  <!-- Front Right Camera -->
  <include if="$(arg use_camera_fr)" file="$(find vehicle_platform)/launch/avt_vimba_camera.launch">
    <arg name="name" value="camera_fr" />
    <arg name="frame_id" value="camera_fr" />
    <arg name="ip" value="192.168.10.1" />
    <arg name="acquisition_rate" value="20" />
  </include>

  <!-- RADARS -->
  <!-- Front Center ESR  -->
  <group if="$(arg use_radar_fc)">
    <include file="$(find delphi_esr)/launch/delphi_esr.launch" ns="radar_fc">
      <arg name="esr_frame_id" value="radar_fc" />
      <arg name="viz_mature_tracks_only" value="true" />
      <arg name="use_kvaser" value="true" />
      <arg name="kvaser_hardware_id" value="10761" />
      <arg name="kvaser_circuit_id" value="1" />
    </include>
    <node pkg="vehicle_platform" name="radar_topic_merger" type="radar_topic_merger" />
  </group>

  <!-- GPS -->
  <group>
    <node if="$(arg use_diagnostics)" pkg="vehicle_platform" type="diagnostics_parser.py" name="diagnostics_parser" />
    <remap from="/diagnostics" to="/gps/diagnostics" />
    <include if="$(arg use_gps)" file="$(find vehicle_platform)/launch/novatel_gps_driver.launch">
      <arg name="ip" value="192.168.100.150" />
      <arg name="port" value="2000" />
      <arg name="imu_rate" value="100" />
    </include>
  </group>

  <!-- DRIVE BY WIRE -->
  <include if="$(arg use_dbw)" file="$(find pacmod3)/launch/pacmod3.launch" ns="pacmod">
    <arg name="pacmod_vehicle_type" value="LEXUS_RX_450H" />
    <arg name="use_kvaser" value="true" />
    <arg name="kvaser_hardware_id" value="10761" />
    <arg name="kvaser_circuit_id" value="0" />
  </include>

  <!-- SSC -->
  <include if="$(arg use_ssc)" file="$(find ssc_pm_lexus)/launch/speed_steering_control.launch" />

  <!-- TRANSFORMS -->
  <node if="$(arg use_tf)" pkg="robot_state_publisher" type="robot_state_publisher" name="vehicle_platform_frames">
    <remap from="robot_description" to="vehicle_platform_frames/robot_description" />
    <param name="robot_description" textfile="$(find vehicle_platform)/config/platform.urdf" />
  </node>

  <!-- DIAGNOSTICS -->
  <include if="$(arg use_diagnostics)" file="$(find vehicle_platform)/launch/diagnostics.launch" >
    <arg name="use_lidar" value="$(arg use_lidar)" />
    <arg name="use_lidar_front" value="$(arg use_lidar_front)" />
    <arg name="use_camera_fl" value="$(arg use_camera_fl)" />
    <arg name="use_camera_fr" value="$(arg use_camera_fr)" />
    <arg name="use_gps" value="$(arg use_gps)" />
  </include>
</launch>
